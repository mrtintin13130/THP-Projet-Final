<% user = @user %> <!-- @user.all -->
<% asked = @asked_exchange.where(applicant_article_id: nil) %> <!-- they asked to me -->
<% my_exchange = @my_exchange.where(applicant_article_id: nil) %> <!-- I asked to them (without ) -->
<% awaiting_exchange = @exchange.
                                where.not(applicant_article_id: [nil, ""]).
                                where(owner_user_id: current_user.id).
                                or(@exchange.
                                            where.not(applicant_article_id: [nil, ""]).
                                            where(applicant_user_id: current_user.id)) %>

<% puts "AAAAAAAAAAAAAAA" %>
<% print awaiting_exchange %>

<h2>Mes échanges</h2>
<h3>Articles demandés</h3>
<% asked.each do |ask| %>
  Vous avez demandé: <%= link_to "#{@article.find_by(id: ask.owner_article_id).title}", article_path(@article.find_by(id: ask.owner_article_id)) %>
  <br>
  à: <%= link_to "#{user.find(ask.owner_user_id).first_name} #{user.find(ask.owner_user_id).last_name}", user_path(user.find(ask.owner_user_id)) %>

  <br>
<% end %>
<h3>On m'a demandé</h3>
<% my_exchange.each do |exc| %>
  <%= link_to "#{user.find(exc.applicant_user_id).first_name} #{user.find(exc.applicant_user_id).last_name}", user_path(user.find_by(id: exc.applicant_user_id)) %>
  <br>
  Aimerait votre article: <%= link_to "#{@article.find_by(id: exc.owner_article_id).title}", article_path(@article.find_by(id: exc.owner_article_id)) %>

  <br>
<% end %>

<h3>Echange en attente de validation</h3>
<% awaiting_exchange.each do |awaiting| %>
  <%= link_to "#{user.find(awaiting.applicant_user_id).first_name} #{user.find(awaiting.applicant_user_id).last_name}", user_path(user.find_by(id: awaiting.applicant_user_id)) %>
  <br>
  Aimerait votre article: <%= link_to "#{@article.find_by(id: awaiting.owner_article_id).title}", article_path(@article.find_by(id: awaiting.owner_article_id)) %>
  <br>
  Contre votre article: <%= link_to "#{@article.find_by(id: awaiting.owner_article_id).title}", article_path(@article.find_by(id: awaiting.owner_article_id)) %>

  <%= link_to "Accepter échange", exchange_path(awaiting) %>
<% end %>
